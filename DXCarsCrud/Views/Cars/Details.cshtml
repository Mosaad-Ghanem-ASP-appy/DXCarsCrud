@using DXCarsCrud.ViewModel
@model CarDetailsViewModel
@{
}
<link href="/css/devextreme/theme.base.css" rel="stylesheet" />
<link href="/css/devextreme/theme.additional.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

<div id="form-container">
    @using (Html.BeginForm("Edit", "Cars", FormMethod.Post))
    {
        <input hidden asp-for="@Model.Car.CarNo" />
    @(
            Html.DevExtreme().Form<CarDetailsViewModel>()
            .ColCount(2)
            .ID("gridForm")
            .Items(items =>
            {
                items.AddSimpleFor(m => m.Car.CarNo).Editor(e => e.TextBox().Disabled(true));
                items.AddSimpleFor(m => m.Car.UserNo);
                items.AddSimpleFor(m => m.Car.ArName);
                items.AddSimpleFor(m => m.Car.EnName);
                items.AddSimpleFor(m => m.Car.CardNo);
                items.AddSimpleFor(m => m.Car.BeginDate);
                items.AddSimpleFor(m => m.Car.EndDate);
                items.AddSimpleFor(m => m.Car.Company);
                items.AddSimpleFor(m => m.Car.ColorNo)
            .Editor(e => e
            .Lookup()
            .DataSource(ds => ds.WebApi().Controller("Cars").LoadAction("ColorsLookup").Key("Value"))
            .ValueExpr("Value")
            .DisplayExpr("Text")
            );
                items.AddSimpleFor(m => m.Car.Model);

                items.AddGroup()
            .ColCount(3)
            .Items(groupItems =>
            {
                groupItems.AddButton()
            .HorizontalAlignment(HorizontalAlignment.Center)
            .ButtonOptions(b => b.Icon("add").Text("New")
            .OnClick(@<text>
        function() {
        $("#gridForm").dxForm('instance').clear();
        }
    </text>));

                groupItems.AddButton()
    .ButtonOptions(b => b.Icon("save").Text("Save")
    .Type(ButtonType.Default)
    .Width(120)
    .UseSubmitBehavior(true)
    );

             groupItems.AddButton()
             .ButtonOptions(b => b.Icon("remove").Text("Delete")
             .Type(ButtonType.Danger)
             .OnClick($"function() {{ if(confirm('Are you sure you want to delete this item?')) {{ $.ajax({{ url: '{Url.Action("Delete", "Cars")}', type: 'DELETE', data: {{ key: {Model.Car.CarNo} }}, success: function() {{ location.href = '{Url.Action("Index", "Cars")}'; }}, error: function() {{ alert('Error deleting item.'); }} }}); }} }}"));



            });

            })
        .FormData(Model)
        )

    }
</div>

<script>

</script>

<nav class="text-center justify-content-center">
    <ul class="pagination justify-content-center">
        <li class="page-item @(@Model.Paginition.First == Model.Paginition.Current ? "disabled" : "")">
            <a class="page-link" asp-controller="Cars" asp-action="Details" asp-route-id="@Model.Paginition.First" aria-label="First">
                <span aria-hidden="true"><<</span>
            </a>
        </li>
        <li class="page-item @(@Model.Paginition.Previous == 0 ? "disabled" : "")">
            <a class="page-link" asp-controller="Cars" asp-action="Details" asp-route-id="@Model.Paginition.Previous" aria-label="Previous">
                <span aria-hidden="true"><</span>
            </a>
        </li>
        <li class="page-item disabled">
            <a class="page-link" asp-controller="Cars" asp-action="Details" asp-route-id="@Model.Paginition.Current" aria-label="Current">
                <span aria-hidden="true">@Model.Paginition.Current</span>
            </a>
        </li>
        <li class="page-item @(@Model.Paginition.Next == 0 ? "disabled" : "")">
            <a class="page-link" asp-controller="Cars" asp-action="Details" asp-route-id="@Model.Paginition.Next" aria-label="Next">
                <span aria-hidden="true">></span>
            </a>
        </li>
        <li class="page-item @(@Model.Paginition.Last == Model.Paginition.Current ? "disabled" : "")">
            <a class="page-link" asp-controller="Cars" asp-action="Details" asp-route-id="@Model.Paginition.Last" aria-label="Last">
                <span aria-hidden="true">>></span>
            </a>
        </li>
    </ul>
</nav>
